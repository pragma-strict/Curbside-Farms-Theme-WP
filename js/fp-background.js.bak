
/**
 * This file contains all logic relating to the background images on the front page
 */

let bgImages = new Array();   // An array of the background images
let bgFocalPoints = new Array(); // Focal points for each img defined by pairs of ints

// Init background images and focal points. Could I have made this cleaner? Yes. 
bgImages[0] = new Image();
bgImages[0].src = 'wp-content/themes/Curbsite/img/fp-3-1.png';
bgFocalPoints[0] = new Array(40, 85);
bgImages[1] = new Image();
bgImages[1].src = 'wp-content/themes/Curbsite/img/fp-1-1.png';
bgFocalPoints[1] = new Array(65, 40);
bgImages[2] = new Image();
bgImages[2].src = 'wp-content/themes/Curbsite/img/fp-23-f3.png';
bgFocalPoints[2] = new Array(65, 40);
bgImages[3] = new Image();
bgImages[3].src = 'wp-content/themes/Curbsite/img/fp-1-2.png';
bgFocalPoints[3] = new Array(65, 40);

// The HTML IDs of each div to contain a bg image
let bgDivIDs = new Array();
bgDivIDs.push('fp-bg-img-1');
bgDivIDs.push('fp-bg-img-2');
bgDivIDs.push('fp-bg-img-3');
bgDivIDs.push('fp-bg-img-4');


/**
 * Do all initialization of the front page bg image
 */
function backgroundInit(){
   // Use CSS to set and position each image
   for(var i = 0; i < bgDivIDs.length; i++){
      var bgDiv = document.getElementById(bgDivIDs[i]);
      bgDiv.style.backgroundImage = "url(\"" + bgImages[i].src + "\")";

      var percentLeft = bgFocalPoints[i][0];
      var percentTop = bgFocalPoints[i][1];
      var imgElement = document.getElementById(bgDivIDs[i]);
      imgElement.style.backgroundPositionX = percentLeft + "%";
      imgElement.style.backgroundPositionY = percentTop + "%";
   }

   // Make the first image visible
   setBgImage(0);
}


/*
   Master function for scaling and positioning the homepage background images
*/
function updateBackgroundSize(){
   for(var i = 0; i < bgDivIDs.length; i++){
      resizeBackgroundImage(bgDivIDs[i]);
   }
}


/*
   Set the image size to fill the screen for a given ID
*/
function resizeBackgroundImage(imageDivID){
   var longestDimension = window.innerWidth;
   if(window.innerHeight >= window.innerWidth){
      longestDimension = window.innerHeight;
   }

   document.getElementById(imageDivID).style.backgroundSize = longestDimension + "px";
}


/*
   Set the background image at the given index to visible (and hide the others)
*/
function setBgImage(sectionIndex){
   if(sectionIndex < bgDivIDs.length){
      // Set opacity of all images above target image to 0
      for(var i = bgDivIDs.length -1; i > sectionIndex; i--){
         document.getElementById(bgDivIDs[i]).style.opacity = "0";
      }

      document.getElementById(bgDivIDs[sectionIndex]).style.opacity = "1";
   }
}



// EXPORT FUNCTIONS
export {  
   updateBackgroundSize,
   backgroundInit,
   setBgImage
};